## ï¼ï¼ï¼åªæœ‰è¿™ä»½æ–‡ä»¶çš„ç«¯å£è®¾ç½®ä¼šéšClashXå¯åŠ¨ç”Ÿæ•ˆ
#---------------------------------------------------#

# HTTP ä»£ç†ç«¯å£
port: 7890

# SOCKS5 ä»£ç†ç«¯å£
socks-port: 7891

# Linux å’Œ macOS çš„ redir ä»£ç†ç«¯å£ (å¦‚éœ€ä½¿ç”¨æ­¤åŠŸèƒ½ï¼Œè¯·å–æ¶ˆæ³¨é‡Š)
redir-port: 7892

# å…è®¸å±€åŸŸç½‘çš„è¿æ¥ï¼ˆå¯ç”¨æ¥å…±äº«ä»£ç†ï¼‰
allow-lan: true

#å¯ç”¨ipv6
ipv6: true

# è§„åˆ™æ¨¡å¼ï¼šGlobalï¼ˆå…¨å±€ä»£ç†ï¼‰/ Ruleï¼ˆè§„åˆ™ï¼‰ / Script(è…³æœ¬) / Directï¼ˆå…¨å±€ç›´è¿ï¼‰
mode: Rule

# è®¾ç½®æ—¥å¿—è¾“å‡ºçº§åˆ« (é»˜è®¤çº§åˆ«ï¼šsilentï¼Œå³ä¸è¾“å‡ºä»»ä½•å†…å®¹ï¼Œä»¥é¿å…å› æ—¥å¿—å†…å®¹è¿‡å¤§è€Œå¯¼è‡´ç¨‹åºå†…å­˜æº¢å‡ºï¼‰ã€‚
# 5 ä¸ªçº§åˆ«ï¼šsilent / info / warning / error / debugã€‚çº§åˆ«è¶Šé«˜æ—¥å¿—è¾“å‡ºé‡è¶Šå¤§ï¼Œè¶Šå€¾å‘äºè°ƒè¯•ï¼Œè‹¥éœ€è¦è¯·è‡ªè¡Œå¼€å¯ã€‚
log-level: silent

# clash çš„ RESTful API
external-controller: '0.0.0.0:9090'

# æ‚¨å¯ä»¥å°†é™æ€ç½‘é¡µèµ„æºï¼ˆå¦‚ clash-dashboardï¼‰æ”¾ç½®åœ¨ä¸€ä¸ªç›®å½•ä¸­ï¼Œclash å°†ä¼šæœåŠ¡äº `${API}/ui`
# å‚æ•°åº”å¡«å†™é…ç½®ç›®å½•çš„ç›¸å¯¹è·¯å¾„æˆ–ç»å¯¹è·¯å¾„ã€‚
# external-ui: folder

# RESTful API çš„å£ä»¤ (å¯é€‰)
secret: ""

# [Meta Feature]
tcp-concurrent: true

# DNS è®¾ç½®
dns:
 enable: true
 ipv6: true
 prefer-h3: true
 listen: 0.0.0.0:53

# default-nameserveråˆå«Bootstrap DNSï¼Œç”¨æ¥è§£é‡Šnameserver
 default-nameserver:
   - 119.29.29.29
   - 223.5.5.5

# å¢å¼ºæ¨¡å¼ï¼Œfake-ip or redir-hostï¼Œredir-hostä»2023.02.16ä¸å†å¯ç”¨
 enhanced-mode: fake-ip  
 
# ä¸çŸ¥é“æ˜¯ä»€ä¹ˆ
 fake-ip-range: 198.18.0.1/16

# lookup hosts and return IP record
 use-hosts: true

# fake ip white domain list, Always return real IP for increased compatibility
 fake-ip-filter:               
   - time.*.com
   - localhost.ptlogin2.qq.com
   - '*.lan'
   - .srv.nintendo.net
   - .stun.*.*
   - .stun.*.*.*
   - .stun.*.*.*.*
   - xbox.*.microsoft.com
   - .xboxlive.com
   

 nameserver:
   - https://223.5.5.5/dns-query
   - https://1.12.12.12/dns-query

# concurrent request with nameserver, fallback used when GEOIP country isn't CN
 fallback:
   - https://8.8.8.8/dns-query
   - https://1.1.1.1/dns-query

 fallback-filter:
  geoip: true
  geoip-code: CN
  ipcidr:
   - 240.0.0.0/4
   - 127.0.0.1/32
   - 0.0.0.0/32

# ä»£ç†èŠ‚ç‚¹
proxy-providers:
  ğŸ”:
    type: http
    path: ./proxy-providers/é¸¡.yaml 
    url: ""
    filter: (4å€]TW)
    interval: 86400
    health-check:
        enable: true
        url: http://www.gstatic.com/generate_204
        interval: 86400


# ç­–ç•¥ç»„
proxy-groups:
  #- name: ğŸ¶
  #  type: load-balance
  #  url: http://www.gstatic.com/generate_204
  #  interval: 1800
  #  strategy: consistent-hashing
  #  use:
  #    - ğŸ”

  - name: ğŸ¶
    type: url-test
    url: http://www.gstatic.com/generate_204
    interval: 3600
    tolerance: 10
    use:
      - ğŸ”

#select æ‰‹åŠ¨é€‰æ‹©ï¼Œè¯¥ç»„åœ¨èŠ‚ç‚¹åˆ—è¡¨ä¸Šï¼Œæ‰‹åŠ¨é€‰æ‹©åˆ—è¡¨æˆ–è€… proxy-group
#url-test å»¶è¿Ÿæœ€ä½èŠ‚ç‚¹ï¼Œæµ‹è¯•è¯¥ç»„æ‰€æœ‰èŠ‚ç‚¹çš„å»¶è¿Ÿ
#fallback å›è½ï¼Œè¿æ¥è¯¥ç»„ç¬¬ä¸€ä¸ªèŠ‚ç‚¹ï¼Œä¸å¯ç”¨æ—¶åˆ‡æ¢åˆ°ä¸‹ä¸€ä¸ªèŠ‚ç‚¹
#load-balance è´Ÿè½½å‡è¡¡ï¼Œç”±è¯¥ç»„2ä¸ªä»¥ä¸Šçš„èŠ‚ç‚¹æä¾›é“¾æ¥
#     strategy:
#     consistent-hashing åŒä¸€ä¸ªåŸŸåä¸‹ä¼šæŒç»­ä½¿ç”¨åŒä¸€ä¸ªip, é»˜è®¤é€‰æ‹©è¯¥é¡¹ï¼Œé˜²æ­¢é¢‘ç¹è·³ipè¢«ç½‘ç«™ban
#     round-robin è½®è¯¢ï¼Œæ¯è®¿é—®ä¸€ä¸ªé“¾æ¥ï¼Œé¡ºåºæ›´æ¢èŠ‚ç‚¹è®¿é—®



rules:
##########è‡ªå®šä¹‰æ·»åŠ åŸŸå###########
#DOMAIN-SUFFIXï¼šåŸŸååç¼€åŒ¹é…      #
#DOMAINï¼šåŸŸååŒ¹é…                #
#DOMAIN-KEYWORDï¼šåŸŸåå…³é”®å­—åŒ¹é…   #
#IP-CIDRï¼šIPæ®µåŒ¹é…               #
#SRC-IP-CIDRï¼šæºIPæ®µåŒ¹é…         #
#GEOIPï¼šGEOIPæ•°æ®åº“ï¼ˆå›½å®¶ä»£ç ï¼‰åŒ¹é… #
#DST-PORTï¼šç›®æ ‡ç«¯å£åŒ¹é…           #
#SRC-PORTï¼šæºç«¯å£åŒ¹é…             #
#PROCESS-NAMEï¼šæºè¿›ç¨‹ååŒ¹é…       #
#RULE-SETï¼šRule Providerè§„åˆ™åŒ¹é… #
#MATCHï¼šå…¨åŒ¹é…                   #
################################


###################################
#å¦‚æœå­˜åœ¨ DPI æ£€æµ‹ï¼Œå¯ä»¥å°è¯•åŠ å…¥è¿™äº›è§„åˆ™#
# WeChat & QQ                     #
#- DST-PORT,80,PROXY ## TCP       #
#- DST-PORT,5222,PROXY            #
#- DST-PORT,5223,PROXY            #
#- DST-PORT,5228,PROXY            #
#- DST-PORT,8000,PROXY # UDP      #
#- DST-PORT,8001,PROXY # UDP      #
#- DST-PORT,8080,PROXY            #
#- DST-PORT,14000,PROXY           #
###################################


###########rules##############
#######ç¬¬ä¸€æ¡è§„åˆ™åŠ å¯†80ç«¯å£é˜²æ­¢å…±äº«æ£€æµ‹
  #- DST-PORT,80,ğŸ¶
  - RULE-SET,Advertising,REJECT
  - RULE-SET,AdvertisingMiTV,REJECT
  - RULE-SET,BlockHttpDNS,REJECT
  - RULE-SET,MyReject,REJECT
  - RULE-SET,iCloudPrivateRelay,ğŸ¶
  - RULE-SET,OpenAI,ğŸ¶
  - RULE-SET,MyDirect,DIRECT
  - RULE-SET,Apple,DIRECT
  - RULE-SET,Microsoft,DIRECT
  - RULE-SET,ChinaMax,DIRECT
  - RULE-SET,LocalLan,DIRECT
  - MATCH,ğŸ¶


rule-providers:


  Advertising:
    type: http
    behavior: classical
    url: "https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Advertising/Advertising_Classical_No_Resolve.yaml"
    path: ./ruleset/Advertising_Classical.yaml
    interval: 604800

  AdvertisingMiTV:
    type: http
    behavior: classical
    url: "https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/AdvertisingMiTV/AdvertisingMiTV_No_Resolve.yaml"
    path: ./ruleset/AdvertisingMiTV.yaml
    interval: 604800

  BlockHttpDNS:
    type: http
    behavior: classical
    url: "https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/BlockHttpDNS/BlockHttpDNS_No_Resolve.yaml"
    path: ./ruleset/BlockHttpDNS.yaml
    interval: 604800

  MyReject:
    type: http
    behavior: classical
    url: "https://raw.githubusercontent.com/Teacher-c/clash/main/MyReject.yaml"
    path: ./ruleset/MyReject.yaml
    interval: 604800

  MyDirect:
    type: http
    behavior: classical
    url: "https://raw.githubusercontent.com/Teacher-c/clash/main/MyDirect.yaml"
    path: ./ruleset/MyDirect.yaml
    interval: 604800

  iCloudPrivateRelay:
    type: http
    behavior: classical
    url: "https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/iCloudPrivateRelay/iCloudPrivateRelay_No_Resolve.yaml"
    path: ./ruleset/iCloudPrivateRelay.yaml
    interval: 604800

  OpenAI:
    type: http
    behavior: classical
    url: "https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/OpenAI/OpenAI_No_Resolve.yaml"
    path: ./ruleset/OpenAI.yaml
    interval: 604800

  Apple:
    type: http
    behavior: classical
    url: "https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Apple/Apple_Classical_No_Resolve.yaml"
    path: ./ruleset/Apple.yaml
    interval: 604800

  Microsoft:
    type: http
    behavior: classical
    url: "https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/release/rule/Clash/Microsoft/Microsoft_No_Resolve.yaml"
    path: ./ruleset/Microsoft.yaml
    interval: 604800

  ChinaMax:
    type: http
    behavior: classical
    url: "https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/ChinaMax/ChinaMax_Classical_No_Resolve.yaml"
    path: ./ruleset/ChinaMax_Classical.yaml
    interval: 604800

  LocalLan:
    type: http
    behavior: classical
    url: "https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Lan/Lan_No_Resolve.yaml"
    path: ./ruleset/Lan.yaml
    interval: 604800

